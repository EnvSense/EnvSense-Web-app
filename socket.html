<html>

<head>
	<script src="/socket.io/socket.io.js"></script>
	<link href="static/css/bootstrap.min.css" rel="stylesheet" />
	<script type="text/javascript" src="static/js/libs/canvasjs.min.js"></script>
</head>

<body>
	<h1>Dashboard</h1>
	<script>
		var socket = io.connect('http://localhost:8080');
		socket.on('news', function(data) {
			console.log(data);
			socket.emit('my other event', {
				my: 'data'
			});
		});

		window.onload = function() {

			var dps = []; // dataPoints

			var chart = new CanvasJS.Chart("chartContainer", {
				title: {
					text: "Live Random Data"
				},
				data: [{
					type: "line",
					dataPoints: dps
				}]
			});

			var xVal = 0;
			var yVal = 100;
			var updateInterval = 100;
			var dataLength = 500; // number of dataPoints visible at any point

			var updateChart = function(count) {
				count = count || 1;
				// count is number of times loop runs to generate random dataPoints.

				for (var j = 0; j < count; j++) {
					yVal = yVal + Math.round(5 + Math.random() * (-5 - 5));
					dps.push({
						x: xVal,
						y: yVal
					});
					xVal++;
				};
				if (dps.length > dataLength) {
					dps.shift();
				}

				chart.render();

			};

			// generates first set of dataPoints
			updateChart(dataLength);

			// update chart after specified time.
			setInterval(function() {
				updateChart()
			}, updateInterval);

		}
	</script>
	<script type="text/javascript" src="static/js/libs/jquery.min.js"></script>
	<script type="text/javascript" src="static/js/libs/bootstrap.min.js"></script>

	<div id="chartContainer"></div>
</body>

</html>
